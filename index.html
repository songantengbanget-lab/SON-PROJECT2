<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SON PROJECT - Tic Tac Toe</title>

<style>
body {
  margin: 0;
  min-height: 100vh;
  background: radial-gradient(circle at top, #111, #000);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: white;
  font-family: Arial, sans-serif;
}

.logo-img {
  width: 120px;
  margin-bottom: 6px;
  filter: drop-shadow(0 0 15px #00f7ff);
}

.logo-text {
  font-size: 1.8rem;
  font-weight: bold;
  color: #00f7ff;
  text-shadow: 0 0 15px #00f7ff;
  margin-bottom: 10px;
}

.score {
  margin-bottom: 10px;
  font-size: 1.1rem;
}

.controls {
  margin-bottom: 10px;
}

button {
  background: #00f7ff;
  border: none;
  padding: 8px 14px;
  margin: 0 4px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
}

.board {
  display: grid;
  grid-template-columns: repeat(3, 100px);
  gap: 10px;
}

.cell {
  width: 100px;
  height: 100px;
  border: 2px solid #00f7ff;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 3rem;
  cursor: pointer;
  transition: 0.2s;
}

.cell:hover {
  box-shadow: 0 0 15px #00f7ff;
  transform: scale(1.05);
}

.status {
  margin-top: 10px;
  font-size: 1.1rem;
}

@media (max-width: 600px) {
  .board {
    grid-template-columns: repeat(3, 80px);
  }
  .cell {
    width: 80px;
    height: 80px;
    font-size: 2.5rem;
  }
}
</style>
</head>

<body>

<img src="logo.png" class="logo-img" alt="SON PROJECT Logo">
<div class="logo-text">SON PROJECT</div>

<div class="score">
  X: <span id="xScore">0</span> | O: <span id="oScore">0</span>
</div>

<div class="controls">
  <button onclick="setMode('AI')">VS AI</button>
  <button onclick="setMode('PVP')">2 Player</button>
  <button onclick="resetBoard()">Reset</button>
</div>

<div class="board" id="board"></div>

<div class="status" id="status">Giliran: X</div>

<!-- MUSIC -->
<audio id="bgm" loop>
  <source src="aboutyou.mp3" type="audio/mpeg">
</audio>

<script>
/* ===== MUSIC (PELAAAAAN & SMOOTH) ===== */
document.addEventListener("click", () => {
  const music = document.getElementById("bgm");
  music.playbackRate = 0.85;
  music.volume = 0;
  music.play();

  let v = 0;
  const fade = setInterval(() => {
    v += 0.05;
    music.volume = v;
    if (v >= 0.6) clearInterval(fade);
  }, 200);
}, { once: true });

/* ===== GAME ===== */
const boardEl = document.getElementById("board");
const statusEl = document.getElementById("status");

let board = Array(9).fill("");
let currentPlayer = "X";
let mode = "AI";
let xScore = 0;
let oScore = 0;

function setMode(m) {
  mode = m;
  resetBoard();
}

function resetBoard() {
  board = Array(9).fill("");
  currentPlayer = "X";
  statusEl.innerText = "Giliran: X";
  render();
}

function render() {
  boardEl.innerHTML = "";
  board.forEach((cell, i) => {
    const div = document.createElement("div");
    div.className = "cell";
    div.innerText = cell;
    div.onclick = () => handleClick(i);
    boardEl.appendChild(div);
  });
}

function handleClick(i) {
  if (board[i] !== "" || checkWinner()) return;

  board[i] = currentPlayer;

  let winner = checkWinner();
  if (winner) return endGame(winner);

  if (mode === "AI" && currentPlayer === "X") {
    currentPlayer = "O";
    bestMove();
    winner = checkWinner();
    if (winner) return endGame(winner);
    currentPlayer = "X";
  } else {
    currentPlayer = currentPlayer === "X" ? "O" : "X";
  }

  statusEl.innerText = "Giliran: " + currentPlayer;
  render();
}

function endGame(winner) {
  if (winner === "tie") {
    statusEl.innerText = "Seri!";
  } else {
    statusEl.innerText = winner + " Menang!";
    if (winner === "X") xScore++;
    if (winner === "O") oScore++;
    document.getElementById("xScore").innerText = xScore;
    document.getElementById("oScore").innerText = oScore;
  }
  render();
}

function checkWinner() {
  const wins = [
    [0,1,2],[3,4,5],[6,7,8],
    [0,3,6],[1,4,7],[2,5,8],
    [0,4,8],[2,4,6]
  ];
  for (let [a,b,c] of wins) {
    if (board[a] && board[a] === board[b] && board[a] === board[c])
      return board[a];
  }
  if (!board.includes("")) return "tie";
  return null;
}

/* ===== AI (MINIMAX) ===== */
function bestMove() {
  let bestScore = -Infinity;
  let move;
  for (let i = 0; i < 9; i++) {
    if (board[i] === "") {
      board[i] = "O";
      let score = minimax(board, 0, false);
      board[i] = "";
      if (score > bestScore) {
        bestScore = score;
        move = i;
      }
    }
  }
  board[move] = "O";
}

const scores = { X: -10, O: 10, tie: 0 };

function minimax(newBoard, depth, isMax) {
  let result = checkWinner();
  if (result) return scores[result];

  if (isMax) {
    let best = -Infinity;
    for (let i = 0; i < 9; i++) {
      if (newBoard[i] === "") {
        newBoard[i] = "O";
        best = Math.max(best, minimax(newBoard, depth + 1, false));
        newBoard[i] = "";
      }
    }
    return best;
  } else {
    let best = Infinity;
    for (let i = 0; i < 9; i++) {
      if (newBoard[i] === "") {
        newBoard[i] = "X";
        best = Math.min(best, minimax(newBoard, depth + 1, true));
        newBoard[i] = "";
      }
    }
    return best;
  }
}

render();
</script>

</body>
</html>
